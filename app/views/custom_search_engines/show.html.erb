<div class="container">
	<div class="row">
		<div class="span7 offset1">
			<!-- breadcrumb -->
			<div class="row-fluid">
				<%= render 'nodes/breadcrumb' %>
			</div>

			<!-- CSE contents -->
			<div class="row-fluid">
				<div class="well">
				<h3>
					<%= @custom_search_engine.specification.title %>
					<div class="btn-group">
					<% if @custom_search_engine.author == current_user %>
					<%= link_to raw('<i class="icon-edit"></i>'), 
								edit_cse_path(@custom_search_engine), class: "btn pull-right", 
								title: t('human.controls.link.edit') %>
					<% end %>
					<% if @custom_search_engine.status == 'draft' %>
					<%= link_to raw('<i class="icon-share"></i>'), 
								share_cse_path(@custom_search_engine), class: "btn pull-right", 
								title: t('human.controls.link.publish') %>
					<% end %>
					</div>
				</h3>
				<div class="row-fluid">
					<div class="cse-grid"><%= link_to @custom_search_engine.author.username, user_path(@custom_search_engine.author) %><span class="divider">â€¢</span><span class="muted"><%=  time_ago_in_words(@custom_search_engine.created_at)%></span></div>
						
					<div class="cse-grid cse-word">
						<blockquote>
  							<p><%= @custom_search_engine.specification.description %></p>
						</blockquote>
					</div>
					<div class="row-fluid">
						<div class="cse-box">
							<div class="row-fluid cse-grid">
								<% if @filter_annotations.any? %>
									<h5><strong><%= I18n.t('human.text.mode_filter') %></strong></h5>
									<% @filter_annotations.each do |annotation| %>
									<p><%= annotation.about %></p>
									<% end %>
								<% end %>
							</div>
							<div class="row-fluid cse-grid">
								<% if @exclude_annotations.any? %>
									<h5><strong><%= I18n.t('human.text.mode_exclude') %></strong></h5>
									<% @exclude_annotations.each do |annotation| %>
									<p><%= annotation.about %></p>
									<% end %>
								<% end %>
							</div>
							<div class="row-fluid cse-grid cse-word">
								<% if @boost_annotations.any? %>
									<h5><strong><%= I18n.t('human.text.mode_boost') %></strong></h5>
									<% @boost_annotations.each do |annotation| %>
									<p><%= annotation.about %></p>
									<% end %>
								<% end %>
							</div>
							<div class="row-fluid cse-grid">
								<div class="span6 offset3">
									<%= get_keep_or_remove_html(@custom_search_engine) %>
								</div>
							</div>
							<% if user_signed_in? %>
							<% unless current_user.own_cse?(@custom_search_engine) %>
							<div class="row-fluid cse-grid">
								<div class="span6 offset3">
									<%= link_to t('human.text.clone_current_cse'), 
											clone_cse_path(@custom_search_engine),
											confirm: I18n.t('human.text.are_u_sure'), 
											class: 'btn btn-block' %>
								</div>
							</div>
							<% end %>
							<% end %>
							<div id="cse-consumers">
							<% if @custom_search_engine.consumers.any? %>
								<div class="cse-divider" id="cse-consumers-divider" ></div>
								<% @custom_search_engine.consumers.limit(50).each do |consumer| %>
								<%= render partial: 'consumer', locals: {consumer: consumer} %>
								<% end %>
								<% if @custom_search_engine.consumers.count > 50 %>
									<div class="row-fluid">
										<div class="span9"></div>
										<div class="span2"><%= link_to I18n.t('human.text.display_more'), cse_consumers_path(@custom_search_engine), remote: true, id: 'more_consumers' %></div>
										<div class="span1"></div>
									</div>
								<% end %>
							<% end %>
							</div>
						</div>
					</div>
				</div>
				</div>				
			</div>
			<div class="row-fluid">
				<%= render partial: 'shared/modal_box' %>
			</div>
			<% if @custom_search_engine.status == 'publish' %>
			<!-- Replies and reply box -->
			<%= render partial: 'replies/index', locals: {object: @custom_search_engine} %>
			<% end %>
		</div>
		<div class="span3">
			<%= render 'shared/dashboard' %>
		</div>
	</div>
</div>